{% extends "base.html" %} {% block title %}I.B.U. Dashboard{% endblock %} {%
block content %}

<div
  class="fixed left-1/2 top-1/2 z-30 -translate-x-1/2 -translate-y-1/2 flex flex-col items-center gap-5 pointer-events-none"
>
  <!-- Images -->
  <div class="flex flex-col items-center gap-6">
    <img
      src="{{ url_for('static', filename='ibu-icon.svg') }}"
      class="w-[340px] max-w-[80vw]"
      alt="I.B.U. Icon"
    />
    <img
      src="{{ url_for('static', filename='ibu-text.svg') }}"
      class="w-[800px] max-w-[80vw]"
      alt="I.B.U. Text"
    />
  </div>

  <!-- Buttons -->
  <div class="hidden md:flex gap-3 pointer-events-auto mb-15">
    <a
      href="{{ url_for('visualization') }}"
      class="px-12 py-6 rounded-3xl text-4xl text-white whitespace-nowrap font-semibold bg-linear-to-br from-[#e06150] to-[#ff7a6b] shadow-lg shadow-orange-500/20 transition hover:scale-[1.03] active:scale-[0.97] inline-flex flex-col"
    >
      <span class="text-4xl font-semibold"> Team Overview </span>
      <span class="text-sm text-white/80 mt-1">
        See overall team performace overtime
      </span>
    </a>

    <a
      href="{{ url_for('trends') }}"
      class="px-12 py-6 rounded-3xl text-4xl text-white whitespace-nowrap font-semibold bg-linear-to-br from-[#66afea] to-[#4b5ba2] shadow-lg shadow-orange-500/20 transition hover:scale-[1.03] active:scale-[0.97] inline-flex flex-col"
    >
      <span class="text-4xl font-semibold"> Trends </span>
      <span class="text-sm text-white/80 mt-1">
        See team(s) & user(s) performace overtime
      </span>
    </a>

    <a
      href="{{ url_for('member_info') }}"
      class="px-12 py-6 rounded-3xl text-4xl text-white whitespace-nowrap font-semibold bg-linear-to-br from-[#667eea] to-[#764ba2] shadow-lg shadow-orange-500/20 transition hover:scale-[1.03] active:scale-[0.97] inline-flex flex-col"
    >
      <span class="text-4xl font-semibold"> Member Tracking </span>
      <span class="text-sm text-white/80 mt-1">
        See members contribution to the team
      </span>
    </a>
  </div>
</div>

<div
  id="stats-panel"
  class="fixed right-6 top-1/2 z-40 -translate-y-1/2 select-none hidden md:block"
>
  <div
    class="w-[320px] max-w-[calc(100vw-2rem)] rounded-2xl border border-orange-700/40 bg-black/5 backdrop-brightness-75 backdrop-blur p-4 text-sm text-white shadow-xl shadow-black/50"
  >
    <div class="mb-4 border-b border-white/10 pb-2">
      <h3 class="text-sm font-semibold tracking-wide text-white/90">
        Team Overview
      </h3>
      <div class="mt-1 mb-1 text-xs text-white/45">
        Data from {{ latest_date }}
      </div>
      <div class="text-[0.7rem] text-white/40">Updated {{ time_ago }}</div>
    </div>

    <!-- Key stats -->
    <div class="space-y-3">
      <!-- Total Points -->
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-2 text-white/70">
          <span>Total Points</span>
        </div>

        <div class="flex items-baseline gap-2 font-semibold tabular-nums">
          <span>{{ stats.total_points|compact }}</span>
          {% if stats.total_points_gain is defined %} {% set g =
          stats.total_points_gain %}
          <span
            class="px-2 py-0.5 rounded-full text-[0.7rem] font-semibold {% if g > 0 %} bg-green-500/15 text-green-300 {% elif g < 0 %} bg-red-500/15 text-red-300 {% else %} bg-white/5 text-white/40 {% endif %}"
          >
            {% if g > 0 %}+{% endif %}{{ g|compact }}</span
          >
          {% endif %}
        </div>
      </div>

      <!-- Active Members -->
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-2 text-white/70">
          <span>Active Members</span>
        </div>

        <div class="flex items-baseline gap-2 font-semibold tabular-nums">
          <span>{{ stats.active_members }}</span>

          {% if stats.active_members_gain is defined %} {% set g =
          stats.active_members_gain %}
          <span
            class="text-xs font-semibold {% if g > 0 %}text-green-400 {% elif g < 0 %}text-red-400 {% else %}text-white/40 {% endif %}"
          >
            {% if g > 0 %}+{% endif %}{{ g }}
          </span>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Divider -->
    <div class="my-4 border-t border-white/10"></div>

    <!-- Top performers -->
    <div>
      <div class="mb-2 flex items-center justify-between text-white/80">
        <span class="text-xs font-semibold tracking-wide uppercase">
          Top Performers
        </span>
      </div>

      {% if stats.top_performers %}
      <div class="space-y-1">
        {% for p in stats.top_performers %} {% set dg = p.gain if p.gain is
        defined else 0 %}
        <div
          class="flex items-center justify-between rounded-lg px-2 py-1 hover:bg-white/5"
        >
          <div class="flex items-center gap-2 min-w-0">
            <span class="w-3 shrink-0 text-right text-xs text-white/40">
              {{ loop.index }}.
            </span>
            <span class="truncate">{{ p.name }}</span>
          </div>

          <div class="flex items-center gap-2 shrink-0 tabular-nums">
            <!-- Points -->
            <span class="text-sm font-medium text-orange-500">
              {{ p.points|compact }}
            </span>

            <!-- Gain pill -->
            <span
              class="px-2 py-0.5 rounded-full text-[0.7rem] font-semibold {% if dg > 0 %} bg-green-500/15 text-green-300 {% elif dg < 0 %} bg-red-500/15 text-red-300 {% else %} bg-white/5 text-white/40 {% endif %}"
            >
              {% if dg > 0 %}+{% endif %}{{ dg|compact }}
            </span>
          </div>
        </div>
        {% endfor %}
      </div>
      {% else %}
      <div class="text-xs text-white/50">No performers yet.</div>
      {% endif %}
    </div>
  </div>
  {% endblock %}
</div>
